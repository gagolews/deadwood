# Python Examples



## How to Install

To install the package from [PyPI](https://pypi.org/project/deadwood), call:

```bash
pip3 install deadwood  # python3 -m pip install deadwood
```

<!-- TODO: for best performance, install quitefastmst from sources -->

<!-- TODO: change to lumbermark -->

## Basic Use

::::{note}
This section is a work in progress.
In the meantime, take a look at the examples in the [reference manual](../pythonapi).

*To learn more about Python, check out my open-access textbook*
[Minimalist Data Wrangling in Python](https://datawranglingpy.gagolewski.com/).
::::

```{python imports,results="hide"}
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import deadwood

def permute_rows(X):
    return X[np.random.choice(len(X), len(X), replace=False), :]

def plot_scatter(X, labels=None):
    deadwood.plot_scatter(X, asp=1, labels=labels, alpha=0.3, markers='o', s=5)
```


```{python settings,results="hide",echo=FALSE}
from tabulate import tabulate
np.set_printoptions(precision=3, threshold=50, edgeitems=50)
pd.set_option("min_rows", 200)
```



Example noisy dataset[^datasetsource]:

[^datasetsource]: The discussed datasets come from
G. Karypis, E.H. Han, V. Kumar,
CHAMELEON: A hierarchical clustering algorithm using dynamic modeling,
*IEEE Transactions on Computers* **32**(8), 68-75, 1999
and are available for download from
[the clustering benchmarks repository](https://clustering-benchmarks.gagolewski.com/).

```{python py_chameleon_t7_10k_dataset,fig.cap="The chameleon_t7_10k dataset",results="hide"}

X1 = permute_rows(np.loadtxt("chameleon_t7_10k.data.gz", ndmin=2))
plot_scatter(X1)
plt.show()
```


Detect outliers with *Deadwood* (default settings):


```{python py_chameleon_t7_10k_deadwood,fig.cap="Outlier detection on chameleon_t7_10k"}
is_outlier = deadwood.Deadwood().fit_predict(X1)
plot_scatter(X1, (is_outlier<0))
plt.show()
```

Fraction of detected outliers:

```{python}
np.mean(is_outlier<0)
```


## Clusters of Unequal Densities

The above dataset consists of clusters of relatively equal densities.
Here is another one, where it is clearly not the case.

```{python py_chameleon_t8_8k_dataset,fig.cap="The chameleon_t8_8k dataset"}
X2 = permute_rows(np.loadtxt("chameleon_t8_8k.data.gz", ndmin=2))
plot_scatter(X2)
plt.show()
```

Detect outliers with *Deadwood* (default settings):

```{python py_chameleon_t8_8k_deadwood,fig.cap="Outlier detection on chameleon_t8_8k"}
is_outlier = deadwood.Deadwood().fit_predict(X2)
plot_scatter(X2, (is_outlier<0))
plt.show()
```

Detect outliers with *Deadwood*, separately in each cluster
determined by [*Genie*](https://genieclust.gagolewski.com/):


```{python py_chameleon_t8_8k_lumbermark,fig.cap="Detected clusters of chameleon_t8_8k"}
import genieclust
clusters = genieclust.Genie(n_clusters=8, gini_threshold=0.5, M=5).fit(X2)
plot_scatter(X2, clusters.labels_)
plt.show()
```

```{python py_chameleon_t8_8k_lumbermark_deadwood,fig.cap="Outlier detection on clusters of chameleon_t8_8k"}
is_outlier = deadwood.Deadwood().fit_predict(clusters)
plot_scatter(X2, (is_outlier<0))
plt.show()
```
