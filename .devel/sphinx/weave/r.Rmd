# R Examples

## How to Install

To install the package from [CRAN](https://CRAN.R-project.org/package=deadwood), call:

```r
install.packages("deadwood")
```

<!-- TODO: for best performance, install quitefastmst from sources -->

<!-- TODO: change to lumbermark -->


## Basic Use

::::{note}
This section is a work in progress.  In the meantime, take a look at
the documentation of the [deadwood](../rapi/deadwood) function.

*To learn more about R, check out my open-access textbook*
[Deep R Programming](https://deepr.gagolewski.com/).
::::


Example noisy dataset[^datasetsource]:

[^datasetsource]: The discussed datasets come from
G. Karypis, E.H. Han, V. Kumar,
CHAMELEON: A hierarchical clustering algorithm using dynamic modeling,
*IEEE Transactions on Computers* **32**(8), 68-75, 1999
and are available for download from
[the clustering benchmarks repository](https://clustering-benchmarks.gagolewski.com/).

```{r r_chameleon_t7_10k_dataset,fig.cap="The chameleon_t7_10k dataset",echo=-1}
par(mar=c(2, 2, 0.5, 0.5))
X1 <- as.matrix(read.table("chameleon_t7_10k.data.gz"))
plot(X1, asp=1, ann=FALSE, col="#00000055")
```


Detect outliers with *Deadwood* (default settings):

```{r r_chameleon_t7_10k_deadwood,fig.cap="Outlier detection on chameleon_t7_10k",echo=-1}
par(mar=c(2, 2, 0.5, 0.5))
library("deadwood")
is_outlier <- deadwood(X1)
plot(X1, asp=1, ann=FALSE, col=c("#00000055","#ff333333")[is_outlier+1])
```


Fraction of detected outliers:

```{r}
mean(is_outlier)
```


## Clusters of Unequal Densities

The above dataset consists of clusters of relatively equal densities.
Here is another one, where it is clearly not the case.

```{r r_chameleon_t8_8k_dataset,fig.cap="The chameleon_t8_8k dataset",echo=-1}
par(mar=c(2, 2, 0.5, 0.5))
X2 <- as.matrix(read.table("chameleon_t8_8k.data.gz"))
plot(X2, asp=1, ann=FALSE, col="#00000055")
```

Detect outliers with *Deadwood* (default settings):

```{r r_chameleon_t8_8k_deadwood,fig.cap="Outlier detection on chameleon_t8_8k",echo=-1}
par(mar=c(2, 2, 0.5, 0.5))
is_outlier <- deadwood(X2)
plot(X2, asp=1, ann=FALSE, col=c("#00000055","#ff333333")[is_outlier+1])
```

Detect outliers with *Deadwood*, separately in each cluster
detected by [*Genie*](https://genieclust.gagolewski.com/):


```{r r_chameleon_t8_8k_lumbermark,fig.cap="Outlier detection on clusters of chameleon_t8_8k",echo=-1}
par(mar=c(2, 2, 0.5, 0.5))
library("genieclust")
clusters <- genie(X2, 8, gini_threshold=0.5, M=5)
is_outlier <- deadwood(clusters)
plot(X2, asp=1, ann=FALSE, col=c("#00000055","#ff333333")[is_outlier+1])
```
